
@{
    ViewBag.Title = "MyCardLose";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <!-- Breadcrumbs -->
<ol class="breadcrumb link-box">
    <li><a class="link-text" href="/">首頁</a></li>
    <li><a class="link-text" href="#">點點卡帳戶</a></li>
    <li class="link-text ">卡片掛失</li>
</ol>
<!-- main-banner -->
<div class="main-banner">
    <img src="~/wwwroot/Image/desktop_img/pic_account_banner.png" alt="" class="img-responsive">
</div>
<!-- 卡片掛失 -->
<div class="container-fluid account-form-box">
    <!-- 步驟 -->
    <div class="stepwizard">
        <div class="row stepwizard-row setup-panel">
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step stepwizard-step-on">
                <span href="#step-1" type="button" class="stepbar-on"><label class="circle">1</label> <span class="Tab-View">掛失條款</span></span>
            </div>
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step">
                <span href="#step-2" type="button" class="stepbar-off" disabled="disabled"><label class="circle">2</label><span class="Tab-View">選擇掛失卡片</span></span>
            </div>
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step">
                <span href="#step-3" type="button" class="stepbar-off" disabled="disabled"><label class="circle">3</label> <span class="Tab-View">完成掛失</span></span>
            </div>
        </div>
    </div>
    <!-- 第一步，掛失條款 -->
    <div class="row setup-content" id="step-1">
        <form class="form-horizontal account-form">
            <div class="col-md-12">
                <!-- 小標題 -->
                <div class="form-group form-item-base">
                    <div class="acc-title">點點卡掛失條款</div>
                </div>
                <!-- 條文 -->
                <div class="form-group">
                    <div class="form-item-base acc-form-box">
                        <!--html start-->
                        <div class="tw_articleTitle" id="import_html">
                            本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。 本卡採無註冊、記名方式發售，若卡片遺失 、遭竊、詐取、毀損、滅失或遭第三者佔有等情事，加值金額視同現金遺失。恕無法提供金額賠償或掛失止付，卡片內之金額及點 數亦無掛失補發服務，請妥善保管使用。
                        </div>
                    </div>
                </div>
                <!-- 同意按鈕 -->
                <div class="form-group">
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  ">
                    </div>
                    <div class="col-xs-12  col-sm-12 col-md-6 col-lg-6">
                        <button type="button" class="account-btn nextBtn" id="btnAgree" style="width:100%">同意</button>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  "></div>
                </div>
            </div>
        </form>
    </div>
    <!-- 第二步，選擇掛失卡片 -->
    <div class="row setup-content" id="step-2">
        <div class="col-md-12">
            <div class="form-group form-item-base">
                <div class="acc-title" id="lblTitle">請勾選欲掛失的點點卡</div>
            </div>
            <div class="row">
                <div class="form-group card-group col-xs-12 col-sm-6 col-md-4">
                    <div class="radio-group">
                        <label class="radio-inline account-text card-radio">
                            <input type="radio" id="card1" value="1" name="losecard" checked><span></span>
                            <img src="~/wwwroot/Image/desktop_img/pic_card01.png" class="img-responsive" alt="Responsive image">
                        </label>
                        <div class="card-payments">
                            <span class="cardinfo-title">卡號</span>
                            <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">點數</span>
                            <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">餘額</span>
                            <span class="cardinfo-text" id="bl_balance">XX 元</span>
                        </div>
                    </div>
                </div>
                <div class="form-group card-group col-xs-12 col-sm-6 col-md-4">
                    <div class="radio-group">
                        <label class="radio-inline account-text card-radio">
                            <input type="radio" id="card2" value="2" name="losecard"><span></span>
                            <img src="~/wwwroot/Image/desktop_img/pic_card02.png" class="img-responsive" alt="Responsive image">
                        </label>
                        <div class="card-payments">
                            <span class="cardinfo-title">卡號</span>
                            <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">點數</span>
                            <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">餘額</span>
                            <span class="cardinfo-text" id="bl_balance">XX 元</span>
                        </div>
                    </div>
                </div>
                <div class="form-group card-group col-xs-12 col-sm-6 col-md-4">
                    <div class="radio-group">
                        <label class="radio-inline account-text card-radio">
                            <input type="radio" id="card3" value="3" name="losecard"><span></span>
                            <img src="~/wwwroot/Image/desktop_img/pic_card01.png" class="img-responsive" alt="Responsive image">
                        </label>
                        <div class="card-payments">
                            <span class="cardinfo-title">卡號</span>
                            <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">點數</span>
                            <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">餘額</span>
                            <span class="cardinfo-text" id="bl_balance">XX 元</span>
                        </div>
                    </div>
                </div>
                <div class="form-group card-group col-xs-12 col-sm-6 col-md-4">
                    <div class="radio-group">
                        <label class="radio-inline account-text card-radio">
                            <input type="radio" id="card4" value="4" name="losecard"><span></span>
                            <img src="~/wwwroot/Image/desktop_img/pic_card01.png" class="img-responsive" alt="Responsive image">
                        </label>
                        <div class="card-payments">
                            <span class="cardinfo-title">卡號</span>
                            <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">點數</span>
                            <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                        </div>
                        <div class="card-payments">
                            <span class="cardinfo-title">餘額</span>
                            <span class="cardinfo-text" id="bl_balance">XX 元</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 下一步按鈕 -->
            <div class="form-group">
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  ">
                </div>
                <div class="col-xs-12  col-sm-12 col-md-6 col-lg-6">
                    <button type="button" class="account-btn nextBtn" data-toggle="modal" data-target="" style="width:100%">下一步</button>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  "></div>
            </div>

            <button type="button" class="account-btn" data-toggle="modal" data-target="#LoseCheck">確認掛失卡片popup</button>
            <button type="button" class="account-btn" data-toggle="modal" data-target="#AgainPassword">掛失確認再次輸入會員密碼popup</button>
            <button type="button" class="account-btn" data-toggle="modal" data-target="#LoseErr">沒有選卡片就下一步的提醒</button>
        </div>
    </div>
    <!-- 第三步，完成掛失 -->
    <div class="container setup-content" id="step-3">
        <div class="row">
            <div class="form-group">
                <div class="form-item-title form-item-title-1 col-xs-12 col-sm-12 col-md-3">
                    <img src="~/wwwroot/Image/desktop_img/ic_done.png" alt="" class="" />
                </div>
                <div class="form-item-input form-item-input-1 form-item-success  col-xs-12 col-sm-12  col-md-6">
                    <h2>已幫您掛失卡片！</h2>
                    <span>
                        Hi, <span id="lblCustName">陳俊吉</span>
                        <br> 這張卡片已經為您完成掛失，掛失後將保留卡片內剩餘金額與點數，提醒您盡快使用「點數餘額轉置」功能，將這張卡片內的剩餘金額與點數轉到其他您已記名的的點點卡，完成轉移後立即生效，即可前往麥當勞餐廳使用，以免喪失您寶貴的權益，謝謝！
                    </span>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  "></div>
            </div>
        </div>
    </div>



    <!-- 確認掛失卡片popup -->
    <div class="modal fade bs-example-modal-md Lose" id="LoseCheck" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content" id="LoseArea">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><img style="margin-left:10px;height:32px;width:32px;" src="~/wwwroot/Image/desktop_img/ic_close.png"></span></button>
                    <h3 class="modal-title" id="mySmallModalLabel">請確認要掛失的卡片</h3>
                </div>
                <div class="modal-body">
                    <div class="alert-text">
                        <span>提醒您，卡片掛失後即無法使用或回復該張卡片。</span>
                    </div>
                    <div class="form-group col-xs-12 col-sm-12 col-md-12" style="text-align=center">
                        <div class="card-popup">
                            <label class="account-text">
                                <img src="~/wwwroot/Image/desktop_img/pic_card01.png" class="img-responsive" alt="Responsive image">
                            </label>
                            <div class="card-payments">
                                <span class="cardinfo-title">卡號</span>
                                <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                            </div>
                            <div class="card-payments">
                                <span class="cardinfo-title">點數</span>
                                <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                            </div>
                            <div class="card-payments">
                                <span class="cardinfo-title">餘額</span>
                                <span class="cardinfo-text" id="bl_balance">XX 元</span>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="card-box-confirm">
                            <button type="button" class="alert-btn" name="btnCardConfirmOK" id="btnCardConfirmOK" data-toggle="modal" data-target="#AgainPassword">下一步</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 掛失確認再次輸入會員密碼popup -->
    <div class="modal fade bs-example-modal-md ReKeyMyPassword" id="AgainPassword" tabindex="-1" role="dialog" aria-labelledby="ReKeyMyPassword">
        <div class="modal-dialog modal-md" role="document">
            <div id="ReKeyMyPasswordArea" class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><img style="margin-left:10px;height:32px;width:32px;" src="~/wwwroot/Image/desktop_img/ic_close.png"></span></button>
                    <h3 class="modal-title" id="mySmallModalLabel">卡片掛失確認</h3>
                </div>
                <div class="modal-body">
                    <span class="alert-text">掛失卡片將無法回復，請再輸入您的會員密碼確認：</span>
                    <input name="txtUIDForgotPassword" type="text" maxlength="10" id="ReKeyMyPassword" class="form-control account-input" placeholder="請輸入您的會員密碼">
                </div>
                <div class="modal-footer center-block " style="padding:0 44px">
                    <button type="button" class="account-btn" data-dismiss="modal" aria-label="Close">送出</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 沒有選卡片就下一步的提醒popup -->
    <div class="modal fade bs-example-modal-md LoseErr" id="LoseErr" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-md" role="document">
            <div class="message-box-body modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><img style="margin-left:10px;height:32px;width:32px;" src="~/wwwroot/Image/desktop_img/ic_close.png"></span></button>
                    <h3 class="modal-title" id="mySmallModalLabel">訊息</h3>
                </div>
                <div id="messageBoxBody" class="modal-body">
                    <span class="alert-text">請選擇欲掛失的卡片</span>
                </div>
                <div class="modal-footer">
                    <button type="button" id="btnMessageBoxConfirm" class="alert-btn" data-dismiss="modal" aria-label="Close">確認</button>
                </div>
                <div class="message-box-footer">&nbsp;</div>
            </div>
        </div>
    </div>
        

</div>

<script>
$(document).ready(function() {

    var navListItems = $('div.setup-panel div span'),
        allWells = $('.setup-content'),
        allNextBtn = $('.nextBtn');

    allWells.hide();

    navListItems.change(function(e) {
        e.preventDefault();
        var $target = $($(this).attr('href')),
            $item = $(this);
        $(".stepwizard-step-in").removeClass("stepwizard-step-in");
        if (!$item.hasClass('disabled')) {
            // navListItems.removeClass('stepbar-on').addClass('stepbar-off');
            $item.addClass('stepbar-on');
            $item.parent().addClass("stepwizard-step-on").addClass("stepwizard-step-in");
            allWells.hide();
            $target.show();
            $target.find('input:eq(0)').focus();
        }
    });

    allNextBtn.click(function () {        
        var curStep = $(this).closest(".setup-content"),
            btnID = $(this).attr("id"),
            curStepBtn = curStep.attr("id"),
            nextStepWizard = $('div.setup-panel div span[href="#' + curStepBtn + '"]').parent().next().children("span"),
            curInputs = curStep.find("input[type='text'],input[type='url']"),
            isValid = true;

        $(".form-group").removeClass("has-error");
        for (var i = 0; i < curInputs.length; i++) {
            if (!curInputs[i].validity.valid) {
                isValid = false;
                $(curInputs[i]).closest(".form-group").addClass("has-error");
            }
        }
        if (isValid) {
            switch (btnID) {
                case "CardSignName":
                    isValid = CardChick();
                    break;
                case "CardNext":
                    isValid = false;
                    $('div.setup-panel div span[href="#step-1"]').trigger('change');
                    ReSet();
                    break;
                case "ExpenseRecords":

                    window.location.href = '/CardAcc/ExpenseRecords'
                    break;
            }
        }
        if (isValid)
            nextStepWizard.removeAttr('disabled').trigger('change');
    });

    $('div.setup-panel div span.stepbar-on').trigger('change');
});

function CardChick() {

    var chkFg = PictureCheck();
    if (chkFg) {
        chkFg = CardIDChick();
        if (!chkFg) {
            alert("Card Err");
        }
    } else {
        alert("picture err");
    }
    if (chkFg) {
        UserData();
    }
    return chkFg;
}


// 回傳記過名的卡片資訊

function UserData() {
    var data = {
        "UserID": "UserID",
        "CardID": "CardID",
        "CardRugNo": "CardRugNo"
    };
    $("#UserID").text(data.UserID);
    $("#CardID").text(data.CardID);
    $("#CardRugNo").text(data.CardRugNo);
}

// 待補充驗證圖形驗證碼跟卡號
function PictureCheck() {
    return true;
}

function CardIDChick() {
    return true;
}

function ReSet() {

    $("#step-1 input").val("");
    $(".stepwizard-step-on:gt(0)").removeClass("stepwizard-step-on");

    //picture reset
}
</script>

