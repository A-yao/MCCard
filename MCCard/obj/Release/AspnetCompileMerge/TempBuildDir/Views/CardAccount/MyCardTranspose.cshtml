
@{
    ViewBag.Title = "MyCardTranspose";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <!-- Breadcrumbs -->
<ol class="breadcrumb link-box">
    <li><a class="link-text" href="/">首頁</a></li>
    <li><a class="link-text" href="#">點點卡帳戶</a></li>
    <li class="link-text ">點數餘額轉置</li>
</ol>
<!-- main-banner -->
<div class="main-banner">
    <img src="~/wwwroot/Image/desktop_img/pic_account_banner.png" alt="" class="img-responsive">
</div>
<!-- 點數餘額轉置 -->
<div class="container-fluid account-form-box">
    <!-- 步驟 -->
    <div class="stepwizard">
        <div class="row stepwizard-row setup-panel">
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step stepwizard-step-on">
                <span href="#step-1" type="button" class="stepbar-on"><label class="circle">1</label> <span class="Tab-View">選擇欲轉置卡片</span></span>
            </div>
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step">
                <span href="#step-2" type="button" class="stepbar-off" disabled="disabled"><label class="circle">2</label><span class="Tab-View">確認轉置資料</span></span>
            </div>
            <div class="col-sm-12 col-md-4 col-lg-4 stepwizard-step">
                <span href="#step-3" type="button" class="stepbar-off" disabled="disabled"><label class="circle">3</label> <span class="Tab-View">轉置成功</span></span>
            </div>
        </div>
    </div>
    <!-- 第一步，選擇卡片 -->
    <div class="row setup-content" id="step-1">
        <div class="col-md-12">
            <div class="form-group form-item-base">
                <div class="acc-title" id="lblTitle">請選擇欲轉置的點點卡</div>
            </div>
            <div class="transfer-box">
                <div class="form-group col-xs-12 col-sm-12 col-md-4 ">
                    <div class="account-text ">
                        <img id="img_card_output" src="~/wwwroot/Image/desktop_img/pic_card05.png" class="img-responsive" alt="" onclick="$('.Transpose').modal('toggle');">
                        <input name=" hidden_card_output" type="hidden" id="hidden_card_output">
                    </div>
                    <span>請選擇轉出卡片</span>
                </div>
                <div class="form-group hidden-xs hidden-sm transfer-img-top col-xs-12 col-sm-12 col-md-4 ">
                    <img src="~/wwwroot/Image/desktop_img/ic_transfer.png" class="img-responsive">
                </div>
                <div class="form-group visible-xs visible-sm transfer-img-top col-xs-12 col-sm-12 ">
                    <img src="~/wwwroot/Image/desktop_img/ic_transfer_down.png" class="img-responsive">
                </div>
                <div class="form-group col-xs-12 col-sm-12 col-md-4">
                    <div class="account-text ">
                        <img id="img_card_output" src="~/wwwroot/Image/desktop_img/pic_card05.png" class="img-responsive" alt="" onclick="$('.Transpose').modal('toggle');">
                        <input name=" hidden_card_output" type="hidden" id="hidden_card_output">
                    </div>
                    <span>請選擇轉入卡片</span>
                </div>
            </div>
            <!-- 下一步按鈕 -->
            <div class="form-group">
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  ">
                </div>
                <div class="col-xs-12  col-sm-12 col-md-6 col-lg-6">
                    <button type="button" class="account-btn nextBtn" data-toggle="modal" data-target="" style="width:100%">確認</button>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 "></div>
            </div>
        </div>
    </div>
    <!-- 第二步，確認轉置資料 -->
    <div class="row setup-content" id="step-2">
        <div class="col-md-12">
            <div class="form-group form-item-base">
                <div class="acc-title" id="lblTitle">請選擇欲轉置的點點卡</div>
            </div>
            <div class="transfer-box">
                <div class="form-group col-xs-12 col-sm-12 col-md-4 ">
                    <div class="account-text ">
                        <img id="img_card_output" src="~/wwwroot/Image/desktop_img/pic_card01.png" class="img-responsive" alt="" onclick="$('.Transpose').modal('toggle');">
                        <input name=" hidden_card_output" type="hidden" id="hidden_card_output">
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">卡號</span>
                        <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">點數</span>
                        <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">餘額</span>
                        <span class="cardinfo-text" id="bl_balance">XX 元</span>
                    </div>
                </div>
                <div class="form-group hidden-xs hidden-sm transfer-img-top col-xs-12 col-sm-12 col-md-4 ">
                    <img src="~/wwwroot/Image/desktop_img/ic_transfer.png" class="img-responsive">
                </div>
                <div class="form-group visible-xs visible-sm transfer-img-top col-xs-12 col-sm-12 ">
                    <img src="~/wwwroot/Image/desktop_img/ic_transfer_down.png" class="img-responsive">
                </div>
                <div class="form-group col-xs-12 col-sm-12 col-md-4">
                    <div class="account-text ">
                        <img id="img_card_output" src="~/wwwroot/Image/desktop_img/pic_card02.png" class="img-responsive" alt="" onclick="$('.Transpose').modal('toggle');">
                        <input name=" hidden_card_output" type="hidden" id="hidden_card_output">
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">卡號</span>
                        <span class="cardinfo-text" id="lbl_cardnumber">1234 5678 3390 2345</span>
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">點數</span>
                        <span class="cardinfo-text" id="lbl_bonus">12345678 點</span>
                    </div>
                    <div class="card-payments">
                        <span class="cardinfo-title">餘額</span>
                        <span class="cardinfo-text" id="bl_balance">XX 元</span>
                    </div>
                </div>
            </div>
            <!-- 下一步按鈕 -->
            <div class="form-group">
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3  ">
                </div>
                <div class="col-xs-12  col-sm-12 col-md-6 col-lg-6">
                    <button type="button" class="account-btn nextBtn" data-toggle="modal" data-target="" style="width:100%">確認</button>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 "></div>
            </div>
        </div>
    </div>
    <!-- 第三步，轉置成功 -->
    <div class="row setup-content" id="step-3">
        <div class="row">
            <div id="regstep" class="form-group">
                <div class="form-item-title form-item-title-1 col-xs-12 col-sm-12 col-md-4">
                    <img src="~/wwwroot/Image/desktop_img/ic_done.png" alt="" class="" />
                </div>
                <div class="form-item-input form-item-input-1 form-item-success  col-xs-12 col-sm-12  col-md-8">
                    <h2>恭喜您點數餘額轉置成功</h2>
                    <span>您可以繼續使用麥當勞點點卡服務，享有更多優惠！</span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="form-item-title form-item-title-1  col-xs-12 col-sm-12 col-md-4">
                <img src="~/wwwroot/Image/desktop_img/card_red.png" alt="">
            </div>
            <div class="form-item-input form-item-input-1 form-item-success  col-xs-12 col-sm-12 col-md-8">
                <form class="form-horizontal ">
                    <div class="form-group cardsign-text">
                        <div class="col-xs-4 col-sm-4 col-md-3 pull-left">帳號：</div>
                        <div class="col-sm-8 col-md-9 " id="UserID">1234567890</div>
                    </div>
                    <div class="form-group cardsign-text">
                        <div class="col-xs-4 col-sm-4 col-md-3 pull-left">卡號：</div>
                        <div class="col-sm-8 col-md-9" id="CardID">1234 1234 5678 1290</div>
                    </div>
                    <div class="form-group cardsign-text">
                        <div class="col-xs-4 col-sm-4 col-md-3 pull-left">認證碼：</div>
                        <div class="col-sm-8 col-md-9" id="CardRugNo">1234567890</div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
$(document).ready(function() {

    var navListItems = $('div.setup-panel div span'),
        allWells = $('.setup-content'),
        allNextBtn = $('.nextBtn');

    allWells.hide();

    navListItems.change(function(e) {
        e.preventDefault();
        var $target = $($(this).attr('href')),
            $item = $(this);
        $(".stepwizard-step-in").removeClass("stepwizard-step-in");
        if (!$item.hasClass('disabled')) {
            // navListItems.removeClass('stepbar-on').addClass('stepbar-off');
            $item.addClass('stepbar-on');
            $item.parent().addClass("stepwizard-step-on").addClass("stepwizard-step-in");
            allWells.hide();
            $target.show();
            $target.find('input:eq(0)').focus();
        }
    });

    allNextBtn.click(function() {
        var curStep = $(this).closest(".setup-content"),
            btnID = $(this).attr("id"),
            curStepBtn = curStep.attr("id"),
            nextStepWizard = $('div.setup-panel div span[href="#' + curStepBtn + '"]').parent().next().children("span"),
            curInputs = curStep.find("input[type='text'],input[type='url']"),
            isValid = true;

        $(".form-group").removeClass("has-error");
        for (var i = 0; i < curInputs.length; i++) {
            if (!curInputs[i].validity.valid) {
                isValid = false;
                $(curInputs[i]).closest(".form-group").addClass("has-error");
            }
        }
        if (isValid) {
            switch (btnID) {
                case "CardSignName":
                    isValid = CardChick();
                    break;
                case "CardNext":
                    isValid = false;
                    $('div.setup-panel div span[href="#step-1"]').trigger('change');
                    ReSet();
                    break;
                case "ExpenseRecords":

                    window.location.href = '/CardAcc/ExpenseRecords'
                    break;
            }
        }
        if (isValid)
            nextStepWizard.removeAttr('disabled').trigger('change');
    });

    $('div.setup-panel div span.stepbar-on').trigger('change');
});

function CardChick() {

    var chkFg = PictureCheck();
    if (chkFg) {
        chkFg = CardIDChick();
        if (!chkFg) {
            alert("Card Err");
        }
    } else {
        alert("picture err");
    }
    if (chkFg) {
        UserData();
    }
    return chkFg;
}


// 回傳記過名的卡片資訊

function UserData() {
    var data = {
        "UserID": "UserID",
        "CardID": "CardID",
        "CardRugNo": "CardRugNo"
    };
    $("#UserID").text(data.UserID);
    $("#CardID").text(data.CardID);
    $("#CardRugNo").text(data.CardRugNo);
}

// 待補充驗證圖形驗證碼跟卡號
function PictureCheck() {
    return true;
}

function CardIDChick() {
    return true;
}

function ReSet() {

    $("#step-1 input").val("");
    $(".stepwizard-step-on:gt(0)").removeClass("stepwizard-step-on");

    //picture reset
}
</script>
